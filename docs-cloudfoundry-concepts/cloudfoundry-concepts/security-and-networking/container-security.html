<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-docs-cloudfoundry-concepts/cloudfoundry-concepts/security-and-networking/container-security" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Container security | Cloud Foundry Documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://svkrieger.github.io/cf-docs-new/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://svkrieger.github.io/cf-docs-new/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://svkrieger.github.io/cf-docs-new/docs-cloudfoundry-concepts/cloudfoundry-concepts/security-and-networking/container-security"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Container security | Cloud Foundry Documentation"><meta data-rh="true" name="description" content="This topic tells you about how  secures the containers"><meta data-rh="true" property="og:description" content="This topic tells you about how  secures the containers"><link data-rh="true" rel="icon" href="/cf-docs-new/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://svkrieger.github.io/cf-docs-new/docs-cloudfoundry-concepts/cloudfoundry-concepts/security-and-networking/container-security"><link data-rh="true" rel="alternate" href="https://svkrieger.github.io/cf-docs-new/docs-cloudfoundry-concepts/cloudfoundry-concepts/security-and-networking/container-security" hreflang="en"><link data-rh="true" rel="alternate" href="https://svkrieger.github.io/cf-docs-new/docs-cloudfoundry-concepts/cloudfoundry-concepts/security-and-networking/container-security" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/cf-docs-new/blog/rss.xml" title="Cloud Foundry Documentation RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/cf-docs-new/blog/atom.xml" title="Cloud Foundry Documentation Atom Feed"><link rel="stylesheet" href="/cf-docs-new/assets/css/styles.b9e5c93a.css">
<script src="/cf-docs-new/assets/js/runtime~main.784a0609.js" defer="defer"></script>
<script src="/cf-docs-new/assets/js/main.6939736b.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/cf-docs-new/img/logo.png"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/cf-docs-new/"><div class="navbar__logo"><img src="/cf-docs-new/img/logo.png" alt="Cloud Foundry Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/cf-docs-new/img/logo.png" alt="Cloud Foundry Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Cloud Foundry Documentation</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/cf-docs-new/docs-cloudfoundry-concepts">General Information</a><a class="navbar__item navbar__link" href="/cf-docs-new/docs-dev-guide">App Developer Guide</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/cloudfoundry" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/cf-docs-new/docs-cloudfoundry-concepts">Cloud Foundry concepts</a><button aria-label="Collapse sidebar category &#x27;Cloud Foundry concepts&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cf-docs-new/docs-cloudfoundry-concepts/cloudfoundry-concepts/overview">Cloud Foundry overview</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/cf-docs-new/docs-cloudfoundry-concepts/cloudfoundry-concepts/security-and-networking">Security and networking</a><button aria-label="Collapse sidebar category &#x27;Security and networking&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cf-docs-new/docs-cloudfoundry-concepts/cloudfoundry-concepts/security-and-networking/asg">App security groups in Cloud Foundry</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/cf-docs-new/docs-cloudfoundry-concepts/cloudfoundry-concepts/security-and-networking/container-security">Container security</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cf-docs-new/docs-cloudfoundry-concepts/cloudfoundry-concepts/security-and-networking/roles">Orgs, spaces, roles, and permissions in Cloud Foundry</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cf-docs-new/docs-cloudfoundry-concepts/cloudfoundry-concepts/security-and-networking/security">Cloud Foundry security</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cf-docs-new/docs-cloudfoundry-concepts/cloudfoundry-concepts/security-and-networking/ssh-conceptual">Cloud Foundry app SSH components and processes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cf-docs-new/docs-cloudfoundry-concepts/cloudfoundry-concepts/security-and-networking/understand-cf-networking">Container-to-container networking</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/cf-docs-new/docs-cloudfoundry-concepts/contribute">Contribute to Cloud Foundry documentation</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/cf-docs-new/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/cf-docs-new/docs-cloudfoundry-concepts"><span itemprop="name">Cloud Foundry concepts</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/cf-docs-new/docs-cloudfoundry-concepts/cloudfoundry-concepts/security-and-networking"><span itemprop="name">Security and networking</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Container security</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Container security</h1></header><p>This topic tells you about how <!-- -->Cloud Foundry<!-- --> secures the containers
that host app instances on Linux.</p>
<p>For an overview of other <!-- -->CF<!-- --> security features, see <a href="/cf-docs-new/docs-cloudfoundry-concepts/cloudfoundry-concepts/security-and-networking/security.html">CF<!-- --> Security</a>.</p>
<p>The sections in this topic provide the following information:</p>
<ul>
<li>
<p><a href="#mechanics">Container Mechanics</a> provides an overview of container isolation.</p>
</li>
<li>
<p><a href="#networking">Inbound and Outbound Traffic from <!-- -->CF</a> provides an overview of container networking and describes how <!-- -->CF<!-- --> admins customize container network traffic rules for their deployment.</p>
</li>
<li>
<p><a href="#security">Container Security</a> describes how <!-- -->CF<!-- --> secures containers by running app instances in unprivileged containers and by hardening them.</p>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-container-mechanics"><a id="mechanics"></a> Container mechanics<a href="#-container-mechanics" class="hash-link" aria-label="Direct link to -container-mechanics" title="Direct link to -container-mechanics">​</a></h2>
<p>Each instance of an app deployed to <!-- -->CF<!-- --> runs within its own self-contained environment, a Garden container. This container isolates processes, memory, and the filesystem using operating system features and the characteristics of the virtual and physical infrastructure where <!-- -->CF<!-- --> is deployed. For more information about Garden containers, see <a href="/cf-docs-new/docs-cloudfoundry-concepts/cloudfoundry-concepts/security-and-networking/architecture/garden.html">Garden</a>.</p>
<p>CF<!-- --> achieves container isolation by namespacing kernel resources that would otherwise be shared. The intended level of isolation is set to prevent multiple containers that are present on the same host from detecting each other. Every container includes a private root filesystem, which includes a Process ID (PID), namespace, network namespace, and mount namespace.</p>
<p>CF<!-- --> creates container filesystems using the Garden Rootfs (GrootFS) tool. It stacks the following using OverlayFS:</p>
<ul>
<li>
<p>A <strong>read-only base filesystem</strong>: This filesystem has the minimal set of operating system packages and Garden-specific modifications common to all containers. Containers can share the same read-only base filesystem because all writes are applied to the read-write layer.</p>
</li>
<li>
<p>A <strong>container-specific read-write layer</strong>: This layer is unique to each container and its size is limited by XFS project quotas. The quotas prevent the read-write layer from overflowing into unallocated space.</p>
</li>
</ul>
<p>For more information about GrootFS, see <a href="/cf-docs-new/docs-cloudfoundry-concepts/cloudfoundry-concepts/security-and-networking/architecture/garden.html#garden-rootfs">Garden RootFS (GrootFS)</a> in <em>Garden</em>.</p>
<p>Resource control is managed using Linux control groups. Associating each container with its own cgroup or job object limits the amount of memory that the container might use. Linux cgroups also require the container to use a fair share of CPU compared to the relative CPU share of other containers.</p>
<p> <!-- -->CF<!-- --> does not support a RedHat Enterprise Linux OS stemcell. This is due to an
inherent security issue with the way RedHat handles user namespacing and container isolation.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="-cpu"><a id="cpu"></a> CPU<a href="#-cpu" class="hash-link" aria-label="Direct link to -cpu" title="Direct link to -cpu">​</a></h3>
<p>Each container is placed in its own cgroup. Cgroups make each container use a fair share of CPU relative to the other containers. This prevents oversubscription on the host VM where one or more containers hog the CPU and leave no computing resources to the others.</p>
<p>The way cgroups allocate CPU time is based on shares. CPU shares do not work as direct percentages of total CPU usage. Instead, a share is relative in a given time window to the shares held by the other containers. The total amount of CPU that can be overall divided among the cgroups is what is left by other processes that might run in the host VM.</p>
<p>Generally, cgroups offers two possibilities for limiting the CPU usage: <em>CPU affinity</em> and <em>CPU bandwidth</em>, the latter of which is used in <!-- -->CF<!-- -->.</p>
<ul>
<li>
<p>CPU affinity consists of binding a cgroup to certain CPU cores. The actual amount of CPU cycles that can be consumed by the cgroup is thus limited to what is available on the bound CPU cores.</p>
</li>
<li>
<p>CPU bandwidth sets the weight of a cgroup with the process scheduler. The process scheduler divides the available CPU cycles among cgroups depending on the shares held by each cgroup, relative to the shares held by the others.
For example, consider two cgroups, one holding two shares and one holding four. Assuming the process scheduler gets to administer 60 CPU cycles, the first cgroup with two shares will get one third of those available CPU cycles, as it holds one third of the overall shares. Similarly, the second cgroup will get 40 cycles, as it holds two thirds of the collective shares.</p>
</li>
</ul>
<p>The calculation of the CPU usage based on the percentage of the total CPU power available is quite sophisticated and is performed regularly as the CPU demands of the various containers fluctuates. Specifically, the percentage of CPU cycles a cgroup gets can be calculated by dividing the <code>cpu.shares</code> it holds by the sum of the <code>cpu.shares</code> of all the cgroups that are currently doing CPU activity, as shown in the following calculation:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">process_cpu_share_percent = cpu.shares / sum_cpu_shares * 100</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>&lt; if vars.platform_code == &#x27;CF&#x27; &gt;
In <!-- -->CF<!-- -->, cgroup shares range from 10 to 1024. The actual number of shares a cgroup gets can be read from the <code>cpu.shares</code> file of the cgroup configurations pseudo-file-system available in the container at <code>/sys/fs/cgroup/cpu</code>. The number of shares given to an apps cgroup depends on the amount of memory the app declares to need in the manifest.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="cpu-shares-algorithm-1">CPU Shares Algorithm 1<a href="#cpu-shares-algorithm-1" class="hash-link" aria-label="Direct link to CPU Shares Algorithm 1" title="Direct link to CPU Shares Algorithm 1">​</a></h4>
<p>When the <a href="https://github.com/cloudfoundry/diego-release/blob/d051f8f94f652369d02db4cf66712645600d5b4a/jobs/rep/spec#L311-L313" target="_blank" rel="noopener noreferrer">Diego <code>containers.set_cpu_weight</code> bosh property</a> is set to false, then <!-- -->CF<!-- --> scales the number of allocated shares linearly with the amount of memory, until the upper limit of 1024 shares (by default).</p>
<p>In this case, there are a handful of variables that play into the CPU shares calculation.</p>
<table><thead><tr><th>variable name</th><th>default value</th><th>configurable?</th><th>link to property</th></tr></thead><tbody><tr><td>cc.cpu_weight_min_memory</td><td>128</td><td>yes</td><td><a href="https://github.com/cloudfoundry/capi-release/blob/e68034308a57296ac12debf05de012c2a14d4c4c/jobs/cloud_controller_ng/spec#L782-L784" target="_blank" rel="noopener noreferrer">bosh property</a></td></tr><tr><td>cc.cpu_weight_max_memory</td><td>8192</td><td>yes</td><td><a href="https://github.com/cloudfoundry/capi-release/blob/e68034308a57296ac12debf05de012c2a14d4c4c/jobs/cloud_controller_ng/spec#L785-L787" target="_blank" rel="noopener noreferrer">bosh property</a></td></tr><tr><td>app_memory_in_mb</td><td>1024</td><td>yes</td><td>this is set in the app manifest</td></tr><tr><td>base_weight</td><td>8192</td><td>no</td><td>n/a</td></tr><tr><td>diego.executor.container_max_cpu_shares</td><td>1024</td><td>yes</td><td><a href="https://github.com/cloudfoundry/diego-release/blob/d051f8f94f652369d02db4cf66712645600d5b4a/jobs/rep/spec#L122-L124C14" target="_blank" rel="noopener noreferrer">bosh property</a></td></tr></tbody></table>
<p>These variables are used in the following algorithm to determine the number of CPU shares for an app:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">app_memory_for_calculation = min( max(cc.cpu_weight_min_memory, app_memory_in_mb), cc.cpu_weight_max_memory)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app_cpu_weight = int( (100 * app_memory_for_calculation) / base_weight)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">process_cpu.shares = int( (diego.executor.container_max_cpu_shares * app_cpu_weight) / 100)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>For example:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cc.cpu_weight_min_memory = 128</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cc.cpu_weight_max_memory = 8192</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app_memory_in_mb = 32</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">base_weight = 8192</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">diego.executor.container_max_cpu_shares = 1024</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app_memory_for_calculation = min(max(cc.cpu_weight_min_memory, app_memory_in_mb)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app_memory_for_calculation = min(max(128, 32), 8192) = min(128, 8192) = 128</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app_cpu_weight = int((100 * app_memory_for_calculation)/base_weight))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">app_cpu_weight = int((100 * 128) / 8192) = int(12800 / 8192) = int(1.56) = 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">process_cpu.shares = int( (diego.executor.container_max_cpu_shares * app_cpu_weight) / 100)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">process_cpu.shares = int( (1024 * 1) / 100) = int(10.24) = 10</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="cpu-shares-algorithm-2">CPU Shares Algorithm 2<a href="#cpu-shares-algorithm-2" class="hash-link" aria-label="Direct link to CPU Shares Algorithm 2" title="Direct link to CPU Shares Algorithm 2">​</a></h4>
<p>When the <a href="https://github.com/cloudfoundry/diego-release/blob/d051f8f94f652369d02db4cf66712645600d5b4a/jobs/rep/spec#L311-L313" target="_blank" rel="noopener noreferrer">Diego containers.set_cpu_weight BOSH
property</a>
is set to true, then <!-- -->CF<!-- --> scales the number of
allocated shares linearly with the amount of memory</p>
<p>In this case, there are two variables that play into the CPU shares calculation.</p>
<table><thead><tr><th>variable name</th><th>default value</th><th>configurable?</th><th>link to property</th></tr></thead><tbody><tr><td>app_memory_in_mb</td><td>1024</td><td>yes</td><td>this is set in the app manifest</td></tr><tr><td>containers.proxy.additional_memory_allocation_mb</td><td>32</td><td>yes</td><td><a href="https://github.com/cloudfoundry/diego-release/blob/3496e1be97844d9813a52665239e14ae89c5db3b/jobs/rep/spec#L250-L252" target="_blank" rel="noopener noreferrer">bosh property</a></td></tr></tbody></table>
<p>In this case, the following algorithm is used to determine the number of CPU shares for an app:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">process_cpu.shares = app_memory_in_mb + containers.proxy.additional_memory_allocation_mb</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>&lt; else &gt;
The actual number of shares a cgroup gets can be read from the <code>cpu.shares</code> file of the cgroup configurations pseudo-file-system available in the container at <code>/sys/fs/cgroup/cpu</code>.
The number of shares given to an apps cgroup depends on the amount of memory the app declares to need in the manifest.
<!-- -->CF<!-- --> scales the number of allocated shares linearly with the amount of memory.</p>
<p>The following algorithm is used to determine the number of CPU shares for an app:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">process_cpu.shares = app_memory_in_mb + 32</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The extra <code>32</code> in the algorithm is to account for the extra memory required for the envoy sidecar proxy.</p>
<p>&lt; end &gt;</p>
<p>&lt; if vars.platform_code == &#x27;CF&#x27; &gt;</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="cpu-share-interaction">CPU Share Interaction<a href="#cpu-share-interaction" class="hash-link" aria-label="Direct link to CPU Share Interaction" title="Direct link to CPU Share Interaction">​</a></h4>
<p>&lt; end &gt;</p>
<p>The next example helps to illustrate this better. Consider three processes: P1, P2 and P3, which are assigned <code>cpu.shares</code> of 5, 20 and 30, respectively.</p>
<p>P1 is active, while P2 and P3 require no CPU. Hence, P1 might use the whole CPU. When P2 joins in and is doing some actual work, such as when a request comes in, the CPU share between P1 and P2 is calculated as follows:</p>
<ul>
<li>P1 -&gt; 5 / (5+20) = 0.2 = 20</li>
<li>P2 -&gt; 20 / (5+20) = 0.8 = 80</li>
<li>P3 (idle)</li>
</ul>
<p>At some point, process P3 joins in. Then the distribution is recalculated again:</p>
<ul>
<li>P1 -&gt; 5 / (5+20+30) = 0.0909 = ~9</li>
<li>P2 -&gt; 20 / (5+20+30) = 0.363 = ~36</li>
<li>P3 -&gt; 30 / (5+20+30) = 0.545 = ~55</li>
</ul>
<p>If P1 become idle, the following recalculation between P2 and P3 takes place:</p>
<ul>
<li>P1 (idle)</li>
<li>P2 -&gt; 20 / (20+30) = 0.4 = 40</li>
<li>P3 -&gt; 30 / (20+30) = 0.6 = 60</li>
</ul>
<p>If P3 finishes or becomes idle, then P2 can consume all the CPU, as another recalculation is performed.</p>
<p>In summary, the cgroup shares are the minimum guaranteed CPU share that the process can get. This limitation becomes effective only when processes on the same host compete for resources.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-inbound-and-outbound-traffic-from-"><a id="networking"></a> Inbound and outbound traffic from <!-- -->CF<a href="#-inbound-and-outbound-traffic-from-" class="hash-link" aria-label="Direct link to -inbound-and-outbound-traffic-from-" title="Direct link to -inbound-and-outbound-traffic-from-">​</a></h2>
<p>Learn about container networking and how <!-- -->CF<!-- --> admins customize
container network traffic rules for their deployment.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="-networking-overview"><a id="net-overview"></a> Networking overview<a href="#-networking-overview" class="hash-link" aria-label="Direct link to -networking-overview" title="Direct link to -networking-overview">​</a></h3>
<p>A host VM has a single IP address. If you configure the deployment with the cluster on a VLAN, as <!-- -->Cloud Foundry<!-- --> recommends, then all traffic goes through the following levels of network address translation, as shown in the following diagram:</p>
<ul>
<li>
<p><strong>Inbound</strong> requests flow from the load balancer through the router to the host Diego Cell, then into the app container. The router determines which app instance receives each request.</p>
</li>
<li>
<p><strong>Outbound</strong> traffic flows from the app container to the Diego Cell, then to the gateway on the Diego Cell&#x27;s virtual network interface. Depending on your IaaS, this gateway might be a NAT to external networks.</p>
</li>
</ul>
<p><img decoding="async" loading="lazy" alt="Networking Architecture diagram" src="data:image/png;base64,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" width="541" height="285" class="img_ev3q"></p>
<p>The networking diagram shows the following:</p>
<ul>
<li>
<p>Inbound requests go to Load Balancer</p>
</li>
<li>
<p>Outbound traffic comes from NAT</p>
</li>
</ul>
<p>Cloud Foundry vLAN (on right side):</p>
<ul>
<li>
<p>Load balancer goes to router and to the app container inside the Diego Cell</p>
</li>
<li>
<p>App container response goes to NAT</p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="-network-traffic-rules"><a id="config-traffic"></a> Network traffic rules<a href="#-network-traffic-rules" class="hash-link" aria-label="Direct link to -network-traffic-rules" title="Direct link to -network-traffic-rules">​</a></h3>
<p>Admins configure rules to govern container network traffic. This is how containers send traffic outside of <!-- -->CF<!-- --> and receive traffic from outside, the Internet. These rules can prevent system access from external networks and between internal components and determine if apps can establish connections over the virtual network interface.</p>
<p>Admins configure these rules at two levels:</p>
<ul>
<li>
<p>Application Security Groups (ASGs) apply network traffic rules at the container level. <!-- -->For more information about ASGs, see [App Security Groups](../adminguide/app-sec-groups.html)</p>
</li>
<li>
<p>Container-to-container networking policies determine app-to-app communication. Within <!-- -->CF<!-- -->, apps can communicate directly with each other, but the containers are isolated from outside <!-- -->CF<!-- -->. <!-- -->For information about administering container-to-container network policies, see <a href="../devguide/deploy-apps/cf-networking.html">Configuring Container-to-Container Networking</a></p>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-container-security"><a id="security"></a> Container security<a href="#-container-security" class="hash-link" aria-label="Direct link to -container-security" title="Direct link to -container-security">​</a></h2>
<p>CF<!-- --> secures containers through the following measures:</p>
<ul>
<li>
<p>Running app instances in unprivileged containers by default. For more information about app instances, see <a href="#types">Types</a>.</p>
</li>
<li>
<p>Hardening containers by limiting function and access rights. For more information about hardening containers, see <a href="#hardening">Hardening</a>.</p>
</li>
<li>
<!-- -->Only allowing outbound connections to public addresses from app containers. This is the original default. Admins can change this behavior by configuring ASGs.<!-- -->
<!-- -->For more information about ASGs, see [App Security Groups](../adminguide/app-sec-groups.html)<!-- -->
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="-types"><a id="types"></a> Types<a href="#-types" class="hash-link" aria-label="Direct link to -types" title="Direct link to -types">​</a></h3>
<p>Garden has the following container types:</p>
<ul>
<li>unprivileged</li>
<li>privileged</li>
</ul>
<p>Currently, <!-- -->CF<!-- --> runs all app instances and staging tasks in unprivileged containers by default. This measure increases security by eliminating the threat of root escalation inside the container.</p>
<p>&lt; if vars.platform_code == &#x27;CF&#x27; &gt;
&lt; partial &#x27;config_manifest&#x27; &gt;
&lt; end &gt;</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="-hardening"><a id="hardening"></a> Hardening<a href="#-hardening" class="hash-link" aria-label="Direct link to -hardening" title="Direct link to -hardening">​</a></h3>
<p>CF<!-- --> mitigates against container breakout and denial of service attacks in
the following ways:</p>
<ul>
<li>
<p>CF<!-- --> uses the full set of Linux namespaces - IPC, Network, Mount, PID, User, UTS - to provide isolation between containers running on the same host. The User namespace is not used for privileged containers. For more information about Linux namespaces, see <a href="http://manpages.ubuntu.com/manpages/xenial/en/man7/namespaces.7.html" target="_blank" rel="noopener noreferrer">namespaces - overview of Linux namespaces</a> in the Ubuntu documentation.</p>
</li>
<li>
<p>In unprivileged containers, <!-- -->Cloud Foundry<!-- --> maps UID/GID 0 (root) inside the container user namespace to a different UID/GID on the host to prevent an app from inheriting UID/GID 0 on the host if it breaks out of the container.</p>
<ul>
<li>CF<!-- --> uses the same UID/GID for all containers.</li>
<li>CF<!-- --> maps all UIDs except UID 0 to themselves. <!-- -->CF<!-- --> maps UID 0 inside the container namespace to <code>MAX_UID-1</code> outside of the container namespace.</li>
<li>Container Root does not grant Host Root permissions.</li>
</ul>
</li>
<li>
<p>CF<!-- --> mounts <code>/proc</code> and <code>/sys</code> as read-only inside containers.</p>
</li>
<li>
<p>CF<!-- --> disallows <code>dmesg</code> access for unprivileged users and all users in unprivileged containers.</p>
</li>
<li>
<p>CF<!-- --> uses <code>chroot</code> when importing docker images from docker registries.</p>
</li>
<li>
<p>CF<!-- --> establishes a container-specific overlay filesystem mount. <!-- -->CF<!-- --> uses <code>pivot_root</code> to move the root filesystem into this overlay, in order to isolate the container from the host system&#x27;s filesystem. For more information about <code>pivot_root</code>, see <a href="http://manpages.ubuntu.com/manpages/trusty/man2/pivot_root.2.html" target="_blank" rel="noopener noreferrer">pivot_root - change the root filesystem</a> in the Ubuntu documentation.</p>
</li>
<li>
<p>CF<!-- --> does not call any binary or script inside the container filesystem, in order to eliminate any dependencies on scripts and binaries inside the root filesystem.</p>
</li>
<li>
<p>CF<!-- --> avoids side-loading binaries in the container through bind mounts or other methods. Instead, it runs the same binary again by reading it from <code>/proc/self/exe</code> whenever it needs to run a binary in a container.</p>
</li>
<li>
<p>CF<!-- --> establishes a virtual ethernet pair for each container for network traffic. For more information, see <a href="#config-traffic">Container Network Traffic</a>. The virtual ethernet pair has the following features:</p>
<ul>
<li>One interface in the pair is inside the container&#x27;s network namespace, and is the only non-loopback interface accessible inside the container.</li>
<li>The other interface remains in the host network namespace and is bridged to the container-side interface.</li>
<li>Egress allow list rules are applied to these interfaces according to ASGs configured by the admin.</li>
<li>First-packet logging rules might also be activated on the TCP allow list rules.</li>
<li>DNAT rules are established on the host to enable traffic ingress from the host interface to allowed ports on the container-side interface.</li>
</ul>
</li>
<li>
<p>CF<!-- --> applies disk quotas using container-specific XFS quotas with the specified disk-quota capacity.</p>
</li>
<li>
<p>CF<!-- --> applies a total memory usage quota through the memory cgroup and destroys the container if the memory usage exceeds the quota.</p>
</li>
<li>
<p>CF<!-- --> applies a fair-use limit to CPU usage for processes inside the container through the <code>cpu.shares</code> control group.</p>
</li>
<li>
<p>CF<!-- --> allows admins to rate limit the maximum bandwidth consumed by single-app containers, configuring <code>rate</code> and <code>burst</code> properties on the <code>silk-cni</code> job.</p>
</li>
<li>
<p>CF<!-- --> limits access to devices using cgroups but explicitly allows the following safe device nodes:</p>
<ul>
<li><code>/dev/full</code></li>
<li><code>/dev/fuse</code></li>
<li><code>/dev/null</code></li>
<li><code>/dev/ptmx</code></li>
<li><code>/dev/pts/*</code></li>
<li><code>/dev/random</code></li>
<li><code>/dev/tty</code></li>
<li><code>/dev/tty0</code></li>
<li><code>/dev/tty1</code></li>
<li><code>/dev/urandom</code></li>
<li><code>/dev/zero</code></li>
<li><code>/dev/tap</code></li>
<li><code>/dev/tun</code></li>
</ul>
</li>
<li>
<p>CF<!-- --> drops the following Linux capabilities for all container processes. Every dropped capability limits the actions the root user can perform.</p>
<ul>
<li><code>CAP_DAC_READ_SEARCH</code></li>
<li><code>CAP_LINUX_IMMUTABLE</code></li>
<li><code>CAP_NET_BROADCAST</code></li>
<li><code>CAP_NET_ADMIN</code></li>
<li><code>CAP_IPC_LOCK</code></li>
<li><code>CAP_IPC_OWNER</code></li>
<li><code>CAP_SYS_MODULE</code></li>
<li><code>CAP_SYS_RAWIO</code></li>
<li><code>CAP_SYS_PTRACE</code></li>
<li><code>CAP_SYS_PACCT</code></li>
<li><code>CAP_SYS_BOOT</code></li>
<li><code>CAP_SYS_NICE</code></li>
<li><code>CAP_SYS_RESOURCE</code></li>
<li><code>CAP_SYS_TIME</code></li>
<li><code>CAP_SYS_TTY_CONFIG</code></li>
<li><code>CAP_LEASE</code></li>
<li><code>CAP_AUDIT_CONTROL</code></li>
<li><code>CAP_MAC_OVERRIDE</code></li>
<li><code>CAP_MAC_ADMIN</code></li>
<li><code>CAP_SYSLOG</code></li>
<li><code>CAP_WAKE_ALARM</code></li>
<li><code>CAP_BLOCK_SUSPEND</code></li>
<li><code>CAP_SYS_ADMIN</code> for unprivileged containers</li>
</ul>
</li>
</ul>
<p>For more information about Linux capabilities, see <a href="http://manpages.ubuntu.com/manpages/xenial/en/man7/capabilities.7.html" target="_blank" rel="noopener noreferrer">capabilities - overview of Linux capabilities</a> in the Ubuntu documentation.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/cloudfoundry/docs-cloudfoundry-concepts/tree/master/content_repos/docs-cloudfoundry-concepts/cloudfoundry-concepts/security-and-networking/container-security.mdx" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2025-04-09T15:13:24.000Z" itemprop="dateModified">Apr 9, 2025</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/cf-docs-new/docs-cloudfoundry-concepts/cloudfoundry-concepts/security-and-networking/asg"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">App security groups in Cloud Foundry</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/cf-docs-new/docs-cloudfoundry-concepts/cloudfoundry-concepts/security-and-networking/roles"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Orgs, spaces, roles, and permissions in Cloud Foundry</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#-container-mechanics" class="table-of-contents__link toc-highlight"><a></a> Container mechanics</a><ul><li><a href="#-cpu" class="table-of-contents__link toc-highlight"><a></a> CPU</a></li></ul></li><li><a href="#-inbound-and-outbound-traffic-from-" class="table-of-contents__link toc-highlight"><a></a> Inbound and outbound traffic from <appruntimeabbr></appruntimeabbr></a><ul><li><a href="#-networking-overview" class="table-of-contents__link toc-highlight"><a></a> Networking overview</a></li><li><a href="#-network-traffic-rules" class="table-of-contents__link toc-highlight"><a></a> Network traffic rules</a></li></ul></li><li><a href="#-container-security" class="table-of-contents__link toc-highlight"><a></a> Container security</a><ul><li><a href="#-types" class="table-of-contents__link toc-highlight"><a></a> Types</a></li><li><a href="#-hardening" class="table-of-contents__link toc-highlight"><a></a> Hardening</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.cloudfoundry.org/community/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Community Website<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://slack.cloudfoundry.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/cloudfoundry/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.youtube.com/channel/UC0ZYS0Y7b5oiVLvxGf4magw" target="_blank" rel="noopener noreferrer" class="footer__link-item">YouTube<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/cloud-foundry?tab=Newest" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://lists.cloudfoundry.org/g/announce" target="_blank" rel="noopener noreferrer" class="footer__link-item">Mailing List<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/cf-docs-new/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/cloudfoundry" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright"><a href="https://svkrieger.github.io/cf-docs-new/">Cloud Foundry Documentation<a> © 2025 <a href="https://cloudfoundry.org">Cloud Foundry Foundation<a>. All Rights Reserved.</a></a></div></div></div></footer></div>
</body>
</html>