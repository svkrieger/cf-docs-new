"use strict";(self.webpackChunkcf_docs_new=self.webpackChunkcf_docs_new||[]).push([[2208],{6346:(e,i,n)=>{n.r(i),n.d(i,{assets:()=>t,contentTitle:()=>r,default:()=>h,frontMatter:()=>l,metadata:()=>s,toc:()=>o});const s=JSON.parse('{"id":"docs-buildpacks/docs/classic-buildpacks/using-buildpacks/understand-buildpacks","title":"Working with buildpacks in Cloud Foundry","description":"This topic tells you about how buildpacks are structured and detected in Cloud Foundry.","source":"@site/content_repos/docs-buildpacks/docs/classic-buildpacks/using-buildpacks/understand-buildpacks.md","sourceDirName":"docs-buildpacks/docs/classic-buildpacks/using-buildpacks","slug":"/docs-buildpacks/docs/classic-buildpacks/using-buildpacks/understand-buildpacks","permalink":"/cf-docs-new/docs-buildpacks/docs/classic-buildpacks/using-buildpacks/understand-buildpacks","draft":false,"unlisted":false,"editUrl":"https://github.com/cloudfoundry/docs-cloudfoundry-concepts/tree/master/content_repos/docs-buildpacks/docs/classic-buildpacks/using-buildpacks/understand-buildpacks.md","tags":[],"version":"current","lastUpdatedAt":1744211508000,"frontMatter":{"title":"Working with buildpacks in Cloud Foundry","owner":"Buildpacks"},"sidebar":"devGuideSidebar","previous":{"title":"What are classic buildpacks?","permalink":"/cf-docs-new/docs-buildpacks/docs/classic-buildpacks/using-buildpacks/"},"next":{"title":"Binary buildpack","permalink":"/cf-docs-new/docs-buildpacks/docs/classic-buildpacks/binary/"}}');var d=n(4848),c=n(8453);const l={title:"Working with buildpacks in Cloud Foundry",owner:"Buildpacks"},r=void 0,t={},o=[{value:"<a></a> Buildpack scripts",id:"-buildpack-scripts",level:2},{value:"<a></a> bin/detect",id:"-bindetect",level:3},{value:"<a></a> bin/supply",id:"-binsupply",level:3},{value:"<a></a> bin/finalize",id:"-binfinalize",level:3},{value:"<a></a> Deprecated bin/compile",id:"-deprecated-bincompile",level:3},{value:"<a></a> bin/release",id:"-binrelease",level:3},{value:"<a></a> Droplet filesystem",id:"-droplet-filesystem",level:2},{value:"<a></a> Buildpack detection",id:"-buildpack-detection",level:2},{value:"<a></a> Sequence of interactions",id:"-sequence-of-interactions",level:2},{value:"<a></a> No buildpack detection",id:"-no-buildpack-detection",level:3},{value:"<a></a> Buildpack detection",id:"-buildpack-detection-1",level:3}];function a(e){const i={a:"a",code:"code",em:"em",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,c.R)(),...e.components};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(i.p,{children:"This topic tells you about how buildpacks are structured and detected in Cloud Foundry."}),"\n",(0,d.jsxs)(i.h2,{id:"-buildpack-scripts",children:[(0,d.jsx)("a",{id:"buildpack-scripts"})," Buildpack scripts"]}),"\n",(0,d.jsxs)(i.p,{children:["A buildpack repository might contain the following scripts in the ",(0,d.jsx)(i.code,{children:"bin"})," directory:"]}),"\n",(0,d.jsxs)(i.ul,{children:["\n",(0,d.jsxs)(i.li,{children:[(0,d.jsx)(i.code,{children:"bin/detect"})," determines whether or not to apply the buildpack to an app."]}),"\n",(0,d.jsxs)(i.li,{children:[(0,d.jsx)(i.code,{children:"bin/supply"})," provides dependencies for an app."]}),"\n",(0,d.jsxs)(i.li,{children:[(0,d.jsx)(i.code,{children:"bin/finalize"})," prepares the app for launch."]}),"\n",(0,d.jsxs)(i.li,{children:[(0,d.jsx)(i.code,{children:"bin/release"})," provides feedback metadata to Cloud Foundry that indicates how you can run the app."]}),"\n",(0,d.jsxs)(i.li,{children:[(0,d.jsx)(i.code,{children:"bin/compile"})," is a deprecated alternative to ",(0,d.jsx)(i.code,{children:"bin/supply"})," and ",(0,d.jsx)(i.code,{children:"bin/finalize"}),"."]}),"\n"]}),"\n",(0,d.jsxs)(i.p,{children:["The ",(0,d.jsx)(i.code,{children:"bin/supply"})," and ",(0,d.jsx)(i.code,{children:"bin/finalize"})," scripts replace the deprecated ",(0,d.jsx)(i.code,{children:"bin/compile"})," script. Older buildpacks might still use ",(0,d.jsx)(i.code,{children:"bin/compile"})," with the latest version of Cloud Foundry. In this case, applying multiple buildpacks to a single app is not supported. Newer buildpacks might still provide ",(0,d.jsx)(i.code,{children:"bin/compile"})," for compatibility with Heroku and older versions of Cloud Foundry."]}),"\n",(0,d.jsxs)(i.p,{children:["The ",(0,d.jsx)(i.code,{children:"bin/supply"})," script is required for non final buildpacks. The ",(0,d.jsx)(i.code,{children:"bin/finalize"})," (or ",(0,d.jsx)(i.code,{children:"bin/compile"}),") script is required for final buildpacks."]}),"\n",(0,d.jsxs)(i.p,{children:["In this topic, the terms ",(0,d.jsx)("em",{children:"non final buildpack"})," and ",(0,d.jsx)("em",{children:"final buildpack"}),", or\n",(0,d.jsx)("em",{children:"last buildpack"}),", are used to describe the process of applying\nmultiple buildpacks to an app."]}),"\n",(0,d.jsx)(i.p,{children:"For example:"}),"\n",(0,d.jsx)(i.pre,{children:(0,d.jsx)(i.code,{children:"cf push APP-NAME -b FIRST-BUILDPACK -b SECOND-BUILDPACK -b FINAL-BUILDPACK\n"})}),"\n",(0,d.jsx)(i.p,{children:"If you use only one buildpack for your app, this buildpack behaves as a final, or last, buildpack.\nWhen using multi buildpack support, the last buildpack in the order is the final buildpack, and\nis able to make changes to the app and determine a start command. All other specified buildpacks are non\nfinal and supply only the dependencies."}),"\n",(0,d.jsxs)(i.h3,{id:"-bindetect",children:[(0,d.jsx)("a",{id:"detect-script"})," bin/detect"]}),"\n",(0,d.jsxs)(i.p,{children:["The ",(0,d.jsx)(i.code,{children:"detect"})," script determines whether or not to apply the buildpack to an app. The script is called with one argument, the ",(0,d.jsx)(i.code,{children:"build"})," directory for the app. The ",(0,d.jsx)(i.code,{children:"build"})," directory contains the app files uploaded when you run ",(0,d.jsx)(i.code,{children:"cf push"}),"."]}),"\n",(0,d.jsxs)(i.p,{children:["The ",(0,d.jsx)(i.code,{children:"detect"})," script returns an exit code of ",(0,d.jsx)(i.code,{children:"0"})," if the buildpack is compatible with the app. In the case of system buildpacks, the script prints the buildpack name, version, and other information to ",(0,d.jsx)(i.code,{children:"STDOUT"}),"."]}),"\n",(0,d.jsxs)(i.p,{children:["The following is an example ",(0,d.jsx)(i.code,{children:"detect"})," script that checks for a Ruby app that is based on the existence of a ",(0,d.jsx)(i.code,{children:"Gemfile"}),":"]}),"\n",(0,d.jsx)(i.pre,{children:(0,d.jsx)(i.code,{className:"language-console",children:'#!/usr/bin/env ruby\n\ngemfile_path = File.join ARGV[0], "Gemfile"\n\nif File.exist?(gemfile_path)\n  puts "Ruby"\n  exit 0\nelse\n  exit 1\nend\n'})}),"\n",(0,d.jsxs)(i.p,{children:["The buildpack ",(0,d.jsx)(i.code,{children:"detect"})," script output provides additional details by the buildpack developer. This includes buildpack version information and a list of configured frameworks and their associated versions."]}),"\n",(0,d.jsx)(i.p,{children:"The following is an example of the detailed information returned by the Java buildpack:"}),"\n",(0,d.jsx)(i.pre,{children:(0,d.jsx)(i.code,{className:"language-ssh",children:"java-buildpack=v3.0-https://github.com/cloudfoundry/java-buildpack.git#3bd15e1 open-jdk-jre=1.8.0_45 spring-auto-reconfiguration=1.7.0_RELEASE tomcat-access-logging-support=2.4.0_RELEASE tomcat-instance=8.0.21 tomcat-lifecycle-support=2.4.0_RELEASE ...\n"})}),"\n",(0,d.jsx)(i.p,{children:"By default, Cloud Foundry detects only one buildpack. When you want to detect multiple\nbuildpacks, you must explicitly specify them."}),"\n",(0,d.jsxs)(i.p,{children:["For more information, see ",(0,d.jsx)(i.a,{href:"#buildpack-detection",children:"Buildpack detection"}),"."]}),"\n",(0,d.jsxs)(i.h3,{id:"-binsupply",children:[(0,d.jsx)("a",{id:"supply-script"})," bin/supply"]}),"\n",(0,d.jsxs)(i.p,{children:["The ",(0,d.jsx)(i.code,{children:"supply"})," script provides dependencies for the app and runs for all buildpacks. All output is sent to ",(0,d.jsx)(i.code,{children:"STDOUT"})," and is relayed to the user through the Cloud Foundry Command Line Interface (cf CLI)."]}),"\n",(0,d.jsx)(i.p,{children:"The script is run with four arguments:"}),"\n",(0,d.jsxs)(i.ul,{children:["\n",(0,d.jsxs)(i.li,{children:["The ",(0,d.jsx)(i.code,{children:"build"})," directory for the app."]}),"\n",(0,d.jsxs)(i.li,{children:["The ",(0,d.jsx)(i.code,{children:"cache"})," directory, which is a location the buildpack can use to store assets during the build process."]}),"\n",(0,d.jsxs)(i.li,{children:["The ",(0,d.jsx)(i.code,{children:"deps"})," directory, which is where dependencies provided by all buildpacks are installed."]}),"\n",(0,d.jsxs)(i.li,{children:["The ",(0,d.jsx)(i.code,{children:"index"}),", which is a number that represents the ordinal position of the buildpack."]}),"\n"]}),"\n",(0,d.jsxs)(i.p,{children:["The ",(0,d.jsx)(i.code,{children:"supply"})," script stores dependencies in the ",(0,d.jsx)(i.code,{children:"deps"}),"/",(0,d.jsx)(i.code,{children:"index"})," directory. It might also look in other directories in ",(0,d.jsx)(i.code,{children:"deps"})," to find dependencies supplied by other buildpacks."]}),"\n",(0,d.jsxs)(i.p,{children:["The ",(0,d.jsx)(i.code,{children:"supply"})," script must not modify anything outside of the ",(0,d.jsx)(i.code,{children:"deps"}),"/",(0,d.jsx)(i.code,{children:"index"})," directory. Staging might fail if such modification is detected."]}),"\n",(0,d.jsxs)(i.p,{children:["The ",(0,d.jsx)(i.code,{children:"cache"})," directory is provided to the ",(0,d.jsx)(i.code,{children:"supply"})," script for the final buildpack and is preserved even when the buildpack is upgraded or changes. The ",(0,d.jsx)(i.code,{children:"finalize"})," script also has access to this cache directory."]}),"\n",(0,d.jsxs)(i.p,{children:["The ",(0,d.jsx)(i.code,{children:"cache"})," directories provided to the ",(0,d.jsx)(i.code,{children:"supply"})," scripts of non final buildpacks are cleared if those buildpacks are upgraded or changed."]}),"\n",(0,d.jsxs)(i.p,{children:["The following is an example of a simple ",(0,d.jsx)(i.code,{children:"supply"})," script:"]}),"\n",(0,d.jsx)(i.pre,{children:(0,d.jsx)(i.code,{className:"language-console",children:'#!/usr/bin/env ruby\n\n#sync output\n\n$stdout.sync = true\n\nbuild_path = ARGV[0]\ncache_path = ARGV[1]\ndeps_path = ARGV[2]\nindex = ARGV[3]\n\ninstall_ruby\n\nprivate\n\ndef install_ruby\n  puts "Installing Ruby"\n\n  # !!! build tasks go here !!!\n  # download ruby\n  # install ruby\nend\n'})}),"\n",(0,d.jsxs)(i.h3,{id:"-binfinalize",children:[(0,d.jsx)("a",{id:"finalize-script"})," bin/finalize"]}),"\n",(0,d.jsxs)(i.p,{children:["The ",(0,d.jsx)(i.code,{children:"finalize"})," script prepares the app for launch and runs only for the last buildpack. All output is sent to ",(0,d.jsx)(i.code,{children:"STDOUT"})," and is relayed to the user through the cf CLI."]}),"\n",(0,d.jsx)(i.p,{children:"The script is run with four arguments:"}),"\n",(0,d.jsxs)(i.ul,{children:["\n",(0,d.jsxs)(i.li,{children:["The ",(0,d.jsx)(i.code,{children:"build"})," directory for the app."]}),"\n",(0,d.jsxs)(i.li,{children:["The ",(0,d.jsx)(i.code,{children:"cache"})," directory, which is a location the buildpack can use to store assets during the build process."]}),"\n",(0,d.jsxs)(i.li,{children:["The ",(0,d.jsx)(i.code,{children:"deps"})," directory, which is where dependencies provided by all buildpacks are installed."]}),"\n",(0,d.jsxs)(i.li,{children:["The ",(0,d.jsx)(i.code,{children:"index"}),", which is a number that represents the ordinal position of the buildpack."]}),"\n"]}),"\n",(0,d.jsxs)(i.p,{children:["The ",(0,d.jsx)(i.code,{children:"finalize"})," script might find dependencies installed by the ",(0,d.jsx)(i.code,{children:"supply"})," script of the same buildpack in ",(0,d.jsx)(i.code,{children:"deps"}),"/",(0,d.jsx)(i.code,{children:"index"})," directory. It might also look in other directories in ",(0,d.jsx)(i.code,{children:"deps"})," to find dependencies that are supplied by other buildpacks."]}),"\n",(0,d.jsxs)(i.p,{children:["The ",(0,d.jsx)(i.code,{children:"cache"})," directory provided to the ",(0,d.jsx)(i.code,{children:"finalize"})," script is preserved even when the buildpack is upgraded or otherwise changes. The ",(0,d.jsx)(i.code,{children:"supply"})," script of the same buildpack also has access to this cache directory."]}),"\n",(0,d.jsxs)(i.p,{children:["The following example shows a simple ",(0,d.jsx)(i.code,{children:"finalize"})," script:"]}),"\n",(0,d.jsx)(i.pre,{children:(0,d.jsx)(i.code,{className:"language-console",children:'#!/usr/bin/env ruby\n\n#sync output\n\n$stdout.sync = true\n\nbuild_path = ARGV[0]\ncache_path = ARGV[1]\ndeps_path = ARGV[2]\nindex = ARGV[3]\n\nsetup_ruby\n\nprivate\n\ndef setup_ruby\n  puts "Configuring your app to use Ruby"\n\n  # !!! build tasks go here !!!\n  # setup ruby\nend\n'})}),"\n",(0,d.jsxs)(i.h3,{id:"-deprecated-bincompile",children:[(0,d.jsx)("a",{id:"compile-script"})," Deprecated bin/compile"]}),"\n",(0,d.jsxs)(i.p,{children:["The ",(0,d.jsx)(i.code,{children:"compile"})," script is deprecated. It encompasses the behavior of the ",(0,d.jsx)(i.code,{children:"supply"})," and ",(0,d.jsx)(i.code,{children:"finalize"})," scripts for single buildpack apps by using the ",(0,d.jsx)(i.code,{children:"build"})," directory to store dependencies."]}),"\n",(0,d.jsx)(i.p,{children:"The script is run with two arguments:"}),"\n",(0,d.jsxs)(i.ul,{children:["\n",(0,d.jsxs)(i.li,{children:["The ",(0,d.jsx)(i.code,{children:"build"})," directory for the app."]}),"\n",(0,d.jsxs)(i.li,{children:["The ",(0,d.jsx)(i.code,{children:"cache"})," directory, which is a location the buildpack can use to store assets during the build process."]}),"\n"]}),"\n",(0,d.jsxs)(i.p,{children:["During the running of the ",(0,d.jsx)(i.code,{children:"compile"})," script, all output is sent to ",(0,d.jsx)(i.code,{children:"STDOUT"})," and relayed to the user through the cf CLI."]}),"\n",(0,d.jsxs)(i.h3,{id:"-binrelease",children:[(0,d.jsx)("a",{id:"release-script"})," bin/release"]}),"\n",(0,d.jsxs)(i.p,{children:["The ",(0,d.jsx)(i.code,{children:"release"})," script provides feedback metadata to Cloud Foundry that indicates how you run the app. The script is run with one argument, the ",(0,d.jsx)(i.code,{children:"build"})," directory. The script must generate a YAML file in the following format:"]}),"\n",(0,d.jsx)(i.pre,{children:(0,d.jsx)(i.code,{className:"language-yaml",children:"default_process_types:\n  web: start_command.filetype\n"})}),"\n",(0,d.jsxs)(i.p,{children:["The ",(0,d.jsx)(i.code,{children:"default_process_types"})," line indicates the type of app being run and the command used to start it. This start command is used if a start command is not specified in the ",(0,d.jsx)(i.code,{children:"cf push"})," or in a Procfile."]}),"\n",(0,d.jsxs)(i.p,{children:["At this time, only the ",(0,d.jsx)(i.code,{children:"web"})," type of apps is supported."]}),"\n",(0,d.jsxs)(i.p,{children:["To define environment variables for your buildpack, add a Bash script to the ",(0,d.jsx)("code",{children:".profile.d"}),"\ndirectory in the root folder of your app."]}),"\n",(0,d.jsxs)(i.p,{children:["The following example shows what a ",(0,d.jsx)(i.code,{children:"release"})," script for a Rack app might return:"]}),"\n",(0,d.jsx)(i.pre,{children:(0,d.jsx)(i.code,{className:"language-bash",children:"default_process_types:\n  web: bundle exec rackup config.ru -p $PORT\n"})}),"\n",(0,d.jsxs)(i.p,{children:["The ",(0,d.jsx)("code",{children:"web"})," command runs as ",(0,d.jsx)("code",{children:"bash -c COMMAND"})," when Cloud Foundry starts your app."]}),"\n",(0,d.jsxs)(i.h2,{id:"-droplet-filesystem",children:[(0,d.jsx)("a",{id:"droplet-filesystem"})," Droplet filesystem"]}),"\n",(0,d.jsxs)(i.p,{children:["The buildpack staging process extracts the droplet into the ",(0,d.jsx)(i.code,{children:"/home/vcap"})," directory inside the instance container and creates the following filesystem tree:"]}),"\n",(0,d.jsx)(i.pre,{children:(0,d.jsx)(i.code,{children:"app/\ndeps/\nlogs/\ntmp/\nstaging_info.yml\n"})}),"\n",(0,d.jsxs)(i.p,{children:["The ",(0,d.jsx)(i.code,{children:"app"})," directory includes the contents of the ",(0,d.jsx)(i.code,{children:"build"})," directory, and the  ",(0,d.jsx)(i.code,{children:"staging_info.yml"})," file contains the staging metadata saved in the droplet."]}),"\n",(0,d.jsxs)(i.h2,{id:"-buildpack-detection",children:[(0,d.jsx)("a",{id:"buildpack-detection"})," Buildpack detection"]}),"\n",(0,d.jsxs)(i.p,{children:["When you push an app, Cloud Foundry uses a detection process to determine a single buildpack to use. For general information about this process, see ",(0,d.jsx)(i.a,{href:"../concepts/how-applications-are-staged.html#stage-buildpack",children:"How Diego Stages Buildpack Apps"})," section of the ",(0,d.jsx)(i.em,{children:"How Apps Are Staged"})," topic."]}),"\n",(0,d.jsxs)(i.p,{children:["During staging, each buildpack has a position in a priority list. You can retrieve this position by running the  ",(0,d.jsx)(i.code,{children:"cf buildpacks"}),"."]}),"\n",(0,d.jsx)(i.p,{children:"Cloud Foundry checks if the buildpack in position 1 is a compatible buildpack. If the position 1 buildpack is not compatible, Cloud Foundry moves on to the buildpack in position 2. Cloud Foundry continues this process until the correct buildpack is found."}),"\n",(0,d.jsxs)(i.p,{children:["If no buildpack is compatible, the ",(0,d.jsx)(i.code,{children:"cf push"})," command fails with the following error:"]}),"\n",(0,d.jsxs)("pre",{class:"terminal",children:[(0,d.jsx)(i.p,{children:"None of the buildpacks detected a compatible application\nExit status 222\nStaging failed: Exited with status 222"}),(0,d.jsx)(i.p,{children:"FAILED\nNoAppDetectedError"})]}),"\n",(0,d.jsxs)(i.p,{children:["For a more detailed account of how Cloud Foundry interacts with the buildpack, see ",(0,d.jsx)(i.a,{href:"#interactions",children:"Sequence of interactions"}),"."]}),"\n",(0,d.jsxs)(i.h2,{id:"-sequence-of-interactions",children:[(0,d.jsx)("a",{id:"interactions"})," Sequence of interactions"]}),"\n",(0,d.jsx)(i.p,{children:"This section describes the sequence of interactions between the Cloud Foundry platform and the buildpack. The sequence of interactions differs depending on whether the platform skips or performs buildpack detection."}),"\n",(0,d.jsxs)(i.h3,{id:"-no-buildpack-detection",children:[(0,d.jsx)("a",{id:"no-detection"})," No buildpack detection"]}),"\n",(0,d.jsxs)(i.p,{children:["Cloud Foundry skips buildpack detection if the developer specifies one or more buildpacks in the app manifest or in the ",(0,d.jsx)(i.code,{children:"cf push APP-NAME -b BUILDPACK-NAME"})," cf CLI command."]}),"\n",(0,d.jsx)(i.p,{children:"If you explicitly specify buildpacks, Cloud Foundry performs the following interactions:"}),"\n",(0,d.jsxs)(i.ol,{children:["\n",(0,d.jsxs)(i.li,{children:["\n",(0,d.jsx)(i.p,{children:"For each buildpack except the last buildpack, the platform:"}),"\n"]}),"\n",(0,d.jsxs)(i.li,{children:["\n",(0,d.jsxs)(i.p,{children:["Creates the ",(0,d.jsx)(i.code,{children:"deps"}),"/",(0,d.jsx)(i.code,{children:"index"})," directory."]}),"\n"]}),"\n",(0,d.jsxs)(i.li,{children:["\n",(0,d.jsxs)(i.p,{children:["Runs ",(0,d.jsx)(i.code,{children:"/bin/supply"})," with the ",(0,d.jsx)(i.code,{children:"build"}),", ",(0,d.jsx)(i.code,{children:"cache"}),", and ",(0,d.jsx)(i.code,{children:"deps"})," directories and the buildpack ",(0,d.jsx)(i.code,{children:"index"}),"."]}),"\n"]}),"\n",(0,d.jsxs)(i.li,{children:["\n",(0,d.jsxs)(i.p,{children:["Accepts any modification of the ",(0,d.jsx)(i.code,{children:"deps"}),"/",(0,d.jsx)(i.code,{children:"index"})," directory."]}),"\n"]}),"\n",(0,d.jsxs)(i.li,{children:["\n",(0,d.jsxs)(i.p,{children:["Accepts any modification of the ",(0,d.jsx)(i.code,{children:"cache"})," directory."]}),"\n"]}),"\n",(0,d.jsxs)(i.li,{children:["\n",(0,d.jsx)(i.p,{children:"Might disallow modification of any other directories."}),"\n"]}),"\n",(0,d.jsxs)(i.li,{children:["\n",(0,d.jsx)(i.p,{children:"For the last buildpack, the platform:"}),"\n"]}),"\n",(0,d.jsxs)(i.li,{children:["\n",(0,d.jsxs)(i.p,{children:["If ",(0,d.jsx)(i.code,{children:"/bin/finalize"})," is present:"]}),"\n"]}),"\n",(0,d.jsxs)(i.li,{children:["\n",(0,d.jsxs)(i.p,{children:["Creates the ",(0,d.jsx)(i.code,{children:"deps"}),"/",(0,d.jsx)(i.code,{children:"index"})," directory if it does not exist."]}),"\n"]}),"\n",(0,d.jsxs)(i.li,{children:["\n",(0,d.jsxs)(i.p,{children:["If ",(0,d.jsx)(i.code,{children:"/bin/supply"})," is present, runs ",(0,d.jsx)(i.code,{children:"/bin/supply"})," with the ",(0,d.jsx)(i.code,{children:"build"}),", ",(0,d.jsx)(i.code,{children:"cache"}),", and ",(0,d.jsx)(i.code,{children:"deps"})," directories and the buildpack ",(0,d.jsx)(i.code,{children:"index"}),"."]}),"\n"]}),"\n",(0,d.jsxs)(i.li,{children:["\n",(0,d.jsxs)(i.p,{children:["Accepts any modification of the ",(0,d.jsx)(i.code,{children:"deps"}),"/",(0,d.jsx)(i.code,{children:"index"})," directory."]}),"\n"]}),"\n",(0,d.jsxs)(i.li,{children:["\n",(0,d.jsxs)(i.p,{children:["Might disallow modification of the ",(0,d.jsx)(i.code,{children:"build"})," directory."]}),"\n"]}),"\n",(0,d.jsxs)(i.li,{children:["\n",(0,d.jsxs)(i.p,{children:["Runs ",(0,d.jsx)(i.code,{children:"/bin/finalize"})," with the ",(0,d.jsx)(i.code,{children:"build"}),", ",(0,d.jsx)(i.code,{children:"cache"}),", and ",(0,d.jsx)(i.code,{children:"deps"})," directories and the buildpack ",(0,d.jsx)(i.code,{children:"index"}),"."]}),"\n"]}),"\n",(0,d.jsxs)(i.li,{children:["\n",(0,d.jsxs)(i.p,{children:["Accepts any modification of the ",(0,d.jsx)(i.code,{children:"build"})," directory."]}),"\n"]}),"\n",(0,d.jsxs)(i.li,{children:["\n",(0,d.jsxs)(i.p,{children:["If ",(0,d.jsx)(i.code,{children:"/bin/finalize"})," is not present:"]}),"\n"]}),"\n",(0,d.jsxs)(i.li,{children:["\n",(0,d.jsxs)(i.p,{children:["Runs ",(0,d.jsx)(i.code,{children:"/bin/compile"})," with the ",(0,d.jsx)(i.code,{children:"build"})," and ",(0,d.jsx)(i.code,{children:"cache"})," directories."]}),"\n"]}),"\n",(0,d.jsxs)(i.li,{children:["\n",(0,d.jsxs)(i.p,{children:["Accepts any modification of the ",(0,d.jsx)(i.code,{children:"build"})," directory."]}),"\n"]}),"\n",(0,d.jsxs)(i.li,{children:["\n",(0,d.jsxs)(i.p,{children:["Runs ",(0,d.jsx)(i.code,{children:"/bin/release"})," to determine staging information."]}),"\n"]}),"\n"]}),"\n",(0,d.jsxs)(i.p,{children:["At the end of this process, the ",(0,d.jsx)(i.code,{children:"deps"})," directory is included at the root of the droplet, adjacent to the ",(0,d.jsx)(i.code,{children:"app"})," directory."]}),"\n",(0,d.jsxs)(i.h3,{id:"-buildpack-detection-1",children:[(0,d.jsx)("a",{id:"detection"})," Buildpack detection"]}),"\n",(0,d.jsxs)(i.p,{children:["Cloud Foundry does buildpack detection if you do not specify one or more buildpacks in the app manifest or in the ",(0,d.jsx)(i.code,{children:"cf push APP-NAME -b BUILDPACK-NAME"})," cf CLI command."]}),"\n",(0,d.jsx)(i.p,{children:"Cloud Foundry detects only one buildpack to use with the app."}),"\n",(0,d.jsx)(i.p,{children:"If the platform performs detection, it:"}),"\n",(0,d.jsxs)(i.ol,{children:["\n",(0,d.jsxs)(i.li,{children:["\n",(0,d.jsxs)(i.p,{children:["Runs ",(0,d.jsx)(i.code,{children:"/bin/detect"})," for each buildpack."]}),"\n"]}),"\n",(0,d.jsxs)(i.li,{children:["\n",(0,d.jsxs)(i.p,{children:["Selects the first buildpack with a ",(0,d.jsx)(i.code,{children:"/bin/detect"})," script that returns a zero exit status."]}),"\n"]}),"\n",(0,d.jsxs)(i.li,{children:["\n",(0,d.jsxs)(i.p,{children:["If ",(0,d.jsx)(i.code,{children:"/bin/finalize"})," is present:"]}),"\n"]}),"\n",(0,d.jsxs)(i.li,{children:["\n",(0,d.jsxs)(i.p,{children:["Creates the ",(0,d.jsx)(i.code,{children:"deps"}),"/",(0,d.jsx)(i.code,{children:"index"})," directory if it does not exist."]}),"\n"]}),"\n",(0,d.jsxs)(i.li,{children:["\n",(0,d.jsxs)(i.p,{children:["If ",(0,d.jsx)(i.code,{children:"/bin/supply"})," is present, runs ",(0,d.jsx)(i.code,{children:"/bin/supply"})," with the ",(0,d.jsx)(i.code,{children:"build"}),", ",(0,d.jsx)(i.code,{children:"cache"}),", and ",(0,d.jsx)(i.code,{children:"deps"})," directories and the buildpack ",(0,d.jsx)(i.code,{children:"index"}),"."]}),"\n"]}),"\n",(0,d.jsxs)(i.li,{children:["\n",(0,d.jsxs)(i.p,{children:["Accepts any modification of the ",(0,d.jsx)(i.code,{children:"deps"}),"/",(0,d.jsx)(i.code,{children:"index"})," directory."]}),"\n"]}),"\n",(0,d.jsxs)(i.li,{children:["\n",(0,d.jsxs)(i.p,{children:["Might disallow modification of the ",(0,d.jsx)(i.code,{children:"build"})," directory."]}),"\n"]}),"\n",(0,d.jsxs)(i.li,{children:["\n",(0,d.jsxs)(i.p,{children:["Runs ",(0,d.jsx)(i.code,{children:"/bin/finalize"})," on the ",(0,d.jsx)(i.code,{children:"build"}),", ",(0,d.jsx)(i.code,{children:"cache"}),", and ",(0,d.jsx)(i.code,{children:"deps"})," directories."]}),"\n"]}),"\n",(0,d.jsxs)(i.li,{children:["\n",(0,d.jsxs)(i.p,{children:["Accepts any modification of the ",(0,d.jsx)(i.code,{children:"build"})," directory."]}),"\n"]}),"\n",(0,d.jsxs)(i.li,{children:["\n",(0,d.jsxs)(i.p,{children:["If ",(0,d.jsx)(i.code,{children:"/bin/finalize"})," is not present:"]}),"\n"]}),"\n",(0,d.jsxs)(i.li,{children:["\n",(0,d.jsxs)(i.p,{children:["Runs ",(0,d.jsx)(i.code,{children:"/bin/compile"})," on the ",(0,d.jsx)(i.code,{children:"build"})," and ",(0,d.jsx)(i.code,{children:"cache"})," directories."]}),"\n"]}),"\n",(0,d.jsxs)(i.li,{children:["\n",(0,d.jsxs)(i.p,{children:["Accepts any modification of the ",(0,d.jsx)(i.code,{children:"build"})," directory."]}),"\n"]}),"\n",(0,d.jsxs)(i.li,{children:["\n",(0,d.jsxs)(i.p,{children:["Runs ",(0,d.jsx)(i.code,{children:"/bin/release"})," to determine staging information."]}),"\n"]}),"\n"]}),"\n",(0,d.jsxs)(i.p,{children:["At the end of this process, the ",(0,d.jsx)(i.code,{children:"deps"})," directory is included at the root of the droplet, adjacent to the ",(0,d.jsx)(i.code,{children:"app"})," directory."]})]})}function h(e={}){const{wrapper:i}={...(0,c.R)(),...e.components};return i?(0,d.jsx)(i,{...e,children:(0,d.jsx)(a,{...e})}):a(e)}},8453:(e,i,n)=>{n.d(i,{R:()=>l,x:()=>r});var s=n(6540);const d={},c=s.createContext(d);function l(e){const i=s.useContext(c);return s.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function r(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(d):e.components||d:l(e.components),s.createElement(c.Provider,{value:i},e.children)}}}]);